<?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml" width="810" height="430">


	<mx:Script>
		<![CDATA[
			import mx.collections.ArrayCollection;
			import net.bing.NewsSortOption;
			import net.bing.NewsRequest;
			import mx.rpc.events.FaultEvent;
			import net.bing.SearchResultEvent;
			import mx.rpc.AsyncToken;
			import net.bing.ArrayOfSourceType;
			import net.bing.SearchRequest;
			import net.bing.AdultOption;
			import net.bing.BingService;
			import mx.core.Application;
			import mx.controls.Alert;
			
			public var adult:AdultOption = new AdultOption();
			
				
			public var sortOption:NewsSortOption = new NewsSortOption();
							
			public var newsRequest:NewsRequest = new NewsRequest();
			
			public function setCategory(category:String):void
			{
				if(category.length > 0)
					newsRequest.Category = "rt_"+ category;
				else newsRequest.Category = "";
			}
						
			public function executeQuery():void
			{
				//search logic
				var bing:BingService = new BingService();

				bing.addEventListener(SearchResultEvent.Search_RESULT, Application.application.searchresults.showResults);
				bing.addEventListener(FaultEvent.FAULT, Application.application.searchresults.showResults);
		
				adult._AdultOption = "Strict";
				sortOption._NewsSortOption = "Date";
				//newsRequest.Category = "rt_Health";
				newsRequest.Offset = 0;
				newsRequest.Count = 15;
				newsRequest.SortBy = sortOption;
		
				var request:SearchRequest = new SearchRequest();
				request.AppId = "8FE9AA6D693C08E68F43A1AF8DECCFB092EA54A3";
	
				request.Query = query.text;
										
				request.Market = "en-us";
				
				request.Adult = adult;
				
				request.News = newsRequest;
				
				request.Latitude = 40.77;
				
				request.Longitude = 73.98;
				
				request.Radius = 10000;
				
				request.Sources = new ArrayOfSourceType(["News"]);
				
				//request.News.Category = "rt_Health";
				
				var token:AsyncToken = bing.search(request);
			}
			[Bindable]
		public var buttons:ArrayCollection = new ArrayCollection([{name: "All", queryString: ""},
							{name: "Business", queryString: "Business"}, 
							{name: "Entertainment", queryString: "Entertainment"}, 
							{name: "Health", queryString: "Health"}, 
							{name: "Politics", queryString: "Politics"}, 
							{name: "Scientific", queryString: "Scientific"}, 
							{name: "Sports", queryString: "Sports"}, 
							{name: "US", queryString: "US"}, 
							{name: "World", queryString: "World"}, 
							{name: "Local", queryString: "Local"}, 
							{name: "Science", queryString: "Science"}]);
		]]>
	</mx:Script>
    <mx:TabBar id="categoryBar" dataProvider="{buttons}" labelField="name" fontWeight="bold"  itemClick="setCategory(buttons[categoryBar.selectedIndex].queryString)"/>
		
	
	<mx:HBox width="806" height="52">
		<mx:Text text="BigNews" width="108" height="39" fontSize="19" color="#1D606E" textAlign="center" fontWeight="bold"/>
		<mx:TextInput id="query" editable="true" width="579" height="39" fontSize="22"/>
		<mx:Button label="Search" click="executeQuery()" width="101" height="39" fontSize="18"/>
	</mx:HBox>
	
</mx:VBox>